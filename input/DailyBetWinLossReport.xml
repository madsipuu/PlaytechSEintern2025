<?xml version="1.0" encoding="UTF-8"?>
<report>
    <reportName>DailyBetWinLossReport</reportName>
    <inputs>
        <input>
            <name>PlayerID</name>
            <type>INTEGER</type>
        </input>
        <input>
            <name>GameID</name>
            <type>INTEGER</type>
        </input>
        <input>
            <name>BetAmount</name>
            <type>DOUBLE</type>
        </input>
        <input>
            <name>WinAmount</name>
            <type>DOUBLE</type>
        </input>
        <input>
            <name>LossAmount</name>
            <type>DOUBLE</type>
        </input>
        <input>
            <name>GameType</name>
            <type>STRING</type>
        </input>
        <input>
            <name>Location</name>
            <type>STRING</type>
        </input>
        <input>
            <name>Device</name>
            <type>STRING</type>
        </input>
        <input>
            <name>SessionID</name>
            <type>STRING</type>
        </input>
        <input>
            <name>StartDateTime</name>
            <type>DATETIME</type>
        </input>
        <input>
            <name>EndDateTime</name>
            <type>DATETIME</type>
        </input>
        <input>
            <name>BetCount</name>
            <type>INTEGER</type>
        </input>
        <input>
            <name>WinCount</name>
            <type>INTEGER</type>
        </input>
        <input>
            <name>LossCount</name>
            <type>INTEGER</type>
        </input>
        <input>
            <name>JackpotWin</name>
            <type>DOUBLE</type>
        </input>
        <input>
            <name>BonusWin</name>
            <type>DOUBLE</type>
        </input>
        <input>
            <name>FreeSpins</name>
            <type>INTEGER</type>
        </input>
        <input>
            <name>Multiplier</name>
            <type>DOUBLE</type>
        </input>
    </inputs>
    <outputs>
        <output>
            <name>StartDate</name>
            <type>DATE</type>
        </output>
        <output>
            <name>BetAmountSum</name>
            <type>DOUBLE</type>
        </output>
        <output>
            <name>WinAmountSum</name>
            <type>DOUBLE</type>
        </output>
        <output>
            <name>LossAmountSum</name>
            <type>DOUBLE</type>
        </output>
        <output>
            <name>PlayersProfit</name>
            <type>DOUBLE</type>
        </output>
    </outputs>
    <outputFormat>JSONL</outputFormat>
    <transformers>
        <transformer>
            <name>DateTimeFormatter</name>
            <parameters>
                <input>StartDateTime</input>
                <format>yyyy-MM-dd</format>
                <output>StartDate</output>
            </parameters>
        </transformer>
        <transformer>
            <name>Aggregator</name>
            <parameters>
                <groupBy>StartDate</groupBy>
                <aggregateBys>
                    <aggregateBy>
                        <input>BetAmount</input>
                        <method>SUM</method>
                        <output>BetAmountSum</output>
                    </aggregateBy>
                    <aggregateBy>
                        <input>WinAmount</input>
                        <method>SUM</method>
                        <output>WinAmountSum</output>
                    </aggregateBy>
                    <aggregateBy>
                        <input>LossAmount</input>
                        <method>SUM</method>
                        <output>LossAmountSum</output>
                    </aggregateBy>
                </aggregateBys>
            </parameters>
        </transformer>
        <transformer>
            <name>MathOperation</name>
            <parameters>
                <inputs>
                    <input>WinAmountSum</input>
                    <input>LossAmountSum</input>
                </inputs>
                <operation>SUBTRACT</operation>
                <output>PlayersProfit</output>
            </parameters>
        </transformer>
        <transformer>
            <name>MathOperation</name>
            <parameters>
                <inputs>
                    <input>PlayersProfit</input>
                    <input>BetAmountSum</input>
                </inputs>
                <operation>SUBTRACT</operation>
                <output>PlayersProfit</output>
            </parameters>
        </transformer>
        <transformer>
            <name>StringFormatter</name>
            <parameters>
                <inputs>
                    <input>BetAmountSum</input>
                </inputs>
                <format>%.2f EUR</format>
                <output>BetAmountSum</output>
            </parameters>
        </transformer>
        <transformer>
            <name>StringFormatter</name>
            <parameters>
                <inputs>
                    <input>WinAmountSum</input>
                </inputs>
                <format>%.2f EUR</format>
                <output>WinAmountSum</output>
            </parameters>
        </transformer>
        <transformer>
            <name>StringFormatter</name>
            <parameters>
                <inputs>
                    <input>LossAmountSum</input>
                </inputs>
                <format>%.2f EUR</format>
                <output>LossAmountSum</output>
            </parameters>
        </transformer>
        <transformer>
            <name>StringFormatter</name>
            <parameters>
                <inputs>
                    <input>PlayersProfit</input>
                </inputs>
                <format>%.2f EUR</format>
                <output>PlayersProfit</output>
            </parameters>
        </transformer>
        <transformer>
            <name>Ordering</name>
            <parameters>
                <input>StartDate</input>
                <order>ASC</order>
            </parameters>
        </transformer>
    </transformers>
</report>
